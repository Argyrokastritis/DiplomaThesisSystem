<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>ÎšÎ±Î¸Î·Î³Î·Ï„Î®Ï‚ - Î Î¯Î½Î±ÎºÎ±Ï‚ Î•Î»Î­Î³Ï‡Î¿Ï…</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial; padding: 20px; max-width: 800px; margin: auto; background-color: #f4f4f4; }
    h2 { color: #333; }
    input, textarea, button { width: 100%; padding: 10px; margin: 5px 0; }
    .topic, .thesis { background: #fff; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    .section { margin-bottom: 40px; }
  </style>
</head>
<body>

  <h2>ğŸ‘¨â€ğŸ« Î Î¯Î½Î±ÎºÎ±Ï‚ Î•Î»Î­Î³Ï‡Î¿Ï… ÎšÎ±Î¸Î·Î³Î·Ï„Î®</h2>

  <div class="section">
    <h3>â• Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î˜Î­Î¼Î±Ï„Î¿Ï‚ Î”Î¹Ï€Î»Ï‰Î¼Î±Ï„Î¹ÎºÎ®Ï‚</h3>
    <form id="topicForm">
      <input type="text" id="title" placeholder="Î¤Î¯Ï„Î»Î¿Ï‚ Î˜Î­Î¼Î±Ï„Î¿Ï‚" required>
      <textarea id="summary" placeholder="Î£ÏÎ½Ï„Î¿Î¼Î· Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®" required></textarea>
      <input type="file" id="pdfFile">
      <button type="submit">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î˜Î­Î¼Î±Ï„Î¿Ï‚</button>
    </form>
  </div>

  <div class="section">
    <h3>ğŸ“‹ Î˜Î­Î¼Î±Ï„Î± Ï€Î¿Ï… Î­Ï‡Ï‰ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹</h3>
    <div id="topicList"></div>
  </div>

  <div class="section">
    <h3>ğŸ“š Î”Î¹Ï€Î»Ï‰Î¼Î±Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ„Î¹Ï‚ Î¿Ï€Î¿Î¯ÎµÏ‚ ÏƒÏ…Î¼Î¼ÎµÏ„Î­Ï‡Ï‰</h3>
    <div id="thesisList"></div>
  </div>

  <script>
    const token = localStorage.getItem('token');
    if (!token) {
      alert('Î ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ Ï€ÏÏÏ„Î±.');
      window.location.href = 'login.html';
    }

    const topicForm = document.getElementById('topicForm');
    const topicList = document.getElementById('topicList');
    const thesisList = document.getElementById('thesisList');

    // POST Î½Î­Î¿ Î¸Î­Î¼Î±
    topicForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = new FormData();
      formData.append('title', topicForm.title.value);
      formData.append('summary', topicForm.summary.value);
      if (topicForm.pdfFile.files[0]) {
        formData.append('pdf', topicForm.pdfFile.files[0]);
      }

      const res = await fetch('http://localhost:5000/api/instructors/topics', {
        method: 'POST',
        headers: { Authorization: `Bearer ${token}` },
        body: formData
      });

      if (res.ok) {
        alert('âœ… Î¤Î¿ Î¸Î­Î¼Î± ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ®Î¸Î·ÎºÎµ!');
        topicForm.reset();
        loadTopics();
      } else {
        alert('âŒ Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·');
      }
    });

    // GET Î¸Î­Î¼Î±Ï„Î± ÎºÎ±Î¸Î·Î³Î·Ï„Î®
    async function loadTopics() {
      const res = await fetch('http://localhost:5000/api/instructors/topics', {
        headers: { Authorization: `Bearer ${token}` }
      });
      const topics = await res.json();

      topicList.innerHTML = '';
      topics.forEach(t => {
        const div = document.createElement('div');
        div.className = 'topic';
        div.innerHTML = `<strong>${t.title}</strong><br>${t.summary}<br>`;
        topicList.appendChild(div);
      });
    }

    // GET Î´Î¹Ï€Î»Ï‰Î¼Î±Ï„Î¹ÎºÎ­Ï‚ ÎºÎ±Î¸Î·Î³Î·Ï„Î®
    async function loadTheses() {
      const res = await fetch('http://localhost:5000/api/instructors/theses', {
        headers: { Authorization: `Bearer ${token}` }
      });
      const theses = await res.json();

      thesisList.innerHTML = '';
      theses.forEach(th => {
        const div = document.createElement('div');
        div.className = 'thesis';
        div.innerHTML = `
          <strong>Î˜Î­Î¼Î±:</strong> ${th.topic.title}<br>
          <strong>Î¦Î¿Î¹Ï„Î·Ï„Î®Ï‚:</strong> ${th.student.name}<br>
          <strong>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·:</strong> ${th.status}<br>
        `;
        thesisList.appendChild(div);
      });
    }

    loadTopics();
    loadTheses();
  </script>

</body>
</html>
